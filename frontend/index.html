<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gmail Agent Registration</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Gmail Agent Registration</h1>
            <p class="subtitle">Connect your Gmail account to enable automated email management</p>
        </div>

        <div class="info-section">
            <h2>What we'll access</h2>
            <ul class="permissions-list">
                <li>
                    <strong>Read your emails</strong>
                    <span>To monitor and process incoming messages</span>
                </li>
                <li>
                    <strong>Send emails on your behalf</strong>
                    <span>To reply to messages automatically</span>
                </li>
                <li>
                    <strong>Create drafts</strong>
                    <span>To prepare responses for your review</span>
                </li>
                <li>
                    <strong>Modify emails</strong>
                    <span>To organize and label messages</span>
                </li>
            </ul>
        </div>

        <form id="registrationForm" class="registration-form">
            <h2>Your Information</h2>

            <div class="form-group">
                <label for="name">Full Name *</label>
                <input type="text" id="name" name="name" required placeholder="John Doe">
            </div>

            <div class="form-group">
                <label for="email">Contact Email *</label>
                <input type="email" id="email" name="email" required placeholder="john@example.com">
            </div>

            <div class="form-group">
                <label for="company">Company</label>
                <input type="text" id="company" name="company" placeholder="Acme Corp (optional)">
            </div>

            <div class="consent">
                <label>
                    <input type="checkbox" id="consent" required>
                    I understand and consent to granting Gmail access permissions
                </label>
            </div>

            <button type="submit" class="connect-button" id="connectBtn">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M19.6 10.23c0-.82-.07-1.42-.23-2.05H10v3.68h5.5c-.11.93-.74 2.33-2.12 3.27l-.02.13 3.08 2.38.21.02c1.96-1.8 3.09-4.46 3.09-7.43z" fill="#4285F4"/>
                    <path d="M10 20c2.7 0 4.96-.89 6.62-2.42l-3.27-2.53c-.86.6-2.02 1.03-3.35 1.03-2.56 0-4.74-1.69-5.52-4.03l-.11.01-3.2 2.47-.04.12C2.44 17.93 5.9 20 10 20z" fill="#34A853"/>
                    <path d="M4.48 11.05c-.2-.6-.32-1.23-.32-1.89 0-.66.11-1.3.31-1.89l-.01-.14-3.24-2.51-.11.05C.39 6.13 0 7.92 0 9.84c0 1.92.39 3.71 1.11 5.17l3.37-2.96z" fill="#FBBC05"/>
                    <path d="M10 3.97c1.82 0 3.04.79 3.74 1.45l2.75-2.68C14.96.99 12.7 0 10 0 5.9 0 2.44 2.07 1.11 5.33l3.36 2.61C5.26 5.66 7.44 3.97 10 3.97z" fill="#EB4335"/>
                </svg>
                Connect Gmail Account
            </button>
        </form>

        <div class="security-notice">
            <p><strong>Security Notice:</strong> Your credentials are encrypted and stored securely. We never share your data with third parties.</p>
        </div>
    </div>

    <script>
        document.getElementById('registrationForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const company = document.getElementById('company').value;
            const consent = document.getElementById('consent').checked;

            if (!consent) {
                alert('Please consent to granting Gmail access permissions');
                return;
            }

            // Store user info in session storage for later retrieval
            sessionStorage.setItem('registrationData', JSON.stringify({
                name,
                email,
                company
            }));

            // Redirect to OAuth flow
            window.location.href = `/auth/google?email=${encodeURIComponent(email)}&name=${encodeURIComponent(name)}&company=${encodeURIComponent(company)}`;
        });
    </script>
</body>
</html>
